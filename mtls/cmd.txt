ğŸ” STEP 2.1 â€” Create CA (ROOT TRUST)
openssl genrsa -out ca.key 4096

openssl req -x509 -new -nodes ^
  -key ca.key ^
  -sha256 -days 365 ^
  -subj "/CN=Internal-CA" ^
  -out ca.crt


âœ… This CA signs both server and client certs

ğŸ” STEP 2.2 â€” Auth Server certificate (WITH localhost)
openssl genrsa -out auth-server.key 2048

openssl req -new   -key auth-server.key   -subj "/CN=localhost"   -out auth-server.csr


Now sign it with SAN ğŸ‘‡

openssl x509 -req -in auth-server.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out auth-server.crt -days 365 -sha256 -extfile ext.cnf


âœ… This fixes TLS hostname mismatch (CRITICAL)

ğŸ” STEP 2.3 â€” Client Backend certificate
openssl genrsa -out client.key 2048

openssl req -new   -key client.key   -subj "/CN=client-backend"   -out client.csr


Sign it:

openssl x509 -req   -in client.csr   -CA ca.crt   -CAkey ca.key   -CAcreateserial   -out client.crt   -days 365   -sha256

âœ… FINAL mtls/ FOLDER CONTENT
mtls/
â”œâ”€â”€ ca.crt
â”œâ”€â”€ ca.key
â”œâ”€â”€ auth-server.crt
â”œâ”€â”€ auth-server.key
â”œâ”€â”€ client.crt
â”œâ”€â”€ client.key


ğŸš¨ DO NOT COMMIT THIS FOLDER